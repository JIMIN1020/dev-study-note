## ğŸ“Â jwt í™œìš©í•˜ê¸°

### âœ”ï¸Â jwt í† í° ë°œí–‰

```jsx
const token = jwt.sign(
  {
    email: userData.email,
    id: userData.id,
  },
  process.env.PRIVATE_KEY,
  { expiresIn: "5m", issuer: "jm" }
);
```

### âœ”ï¸Â cookieì— ë‹´ì•„ ë³´ë‚´ê¸°

```jsx
res.cookie("token", token, {
  httpOnly: true,
});
```

### âœ”ï¸Â jwt ê°€ì ¸ì˜¤ê¸°

í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­ ì‹œì— í—¤ë”ì— ë‹´ì•„ë³´ë‚¸ í† í°ì„ êº¼ë‚¸ë‹¤.

```jsx
const token = req.headers["authorization"];
```

### âœ”ï¸Â decoded

jwt í† í°ì„ ê²€ì¦í•˜ë ¤ë©´ verify ë©”ì†Œë“œì˜ ì²«ë²ˆì§¸ ì¸ìë¡œ í† í°, ë‘ë²ˆì§¸ ì¸ìë¡œ ë¹„ë°€í‚¤ë¥¼ ì „ë‹¬í•œë‹¤.

```jsx
const decodedJWT = jwt.verify(token, process.env.PRIVATE_KEY);
```

ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‚˜ì˜¨ë‹¤.

```jsx
{
	email: 'jm5@xxx.com',
	id: 18,
	iat: 1713750956,  // ë°œí–‰ ì‹œì 
	exp: 1713751256,  // ë§Œë£Œ ì‹œì 
	iss: 'jm'  // ë°œí–‰ì
}
```

### âœ”ï¸Â jwt ê²€ì¦ í•¨ìˆ˜ ëª¨ë“ˆí™”

req ê°ì²´ë¥¼ ë°›ì•„ì„œ jwtë¥¼ ê²€ì¦í•˜ê³  ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.

```jsx
require("dotenv").config();
const jwt = require("jsonwebtoken");

const verifyToken = (req) => {
  const token = req.headers["authorization"];
  const decodedJWT = jwt.verify(token, process.env.PRIVATE_KEY);
  return decodedJWT;
};

module.exports = verifyToken;
```

<br/>

## ğŸ“Â JWT ì˜ˆì™¸ ì²˜ë¦¬

í´ë¼ì´ì–¸íŠ¸ê°€ ë§Œë£Œëœ í† í°ì„ í—¤ë”ì— ë„£ì–´ ë³´ë‚´ë©´ ì—ëŸ¬ê°€ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— ë§Œë£Œëœ í† í°ì— ëŒ€í•œ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•´ì¤˜ì•¼ í•œë‹¤.

### âœ”ï¸Â JWT ê´€ë ¨ ì—ëŸ¬

- **TokenExpiredError**: ìœ íš¨ê¸°ê°„ì´ ì§€ë‚œ í† í° = ë§Œë£Œëœ í† í°
- **JsonWebTokenError**: ë¬¸ì œê°€ ìˆëŠ” í† í°

### âœ”ï¸Â try-catchë¡œ ì²˜ë¦¬í•˜ê¸°

```jsx
const verifyToken = (req) => {
  try {
    const token = req.headers["authorization"];
    const decodedJWT = jwt.verify(token, process.env.PRIVATE_KEY);
    return decodedJWT;
  } catch (err) {
    if (err instanceof jwt.TokenExpiredError) {
      throw new CustomError(
        "ë¡œê·¸ì¸ ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤.",
        StatusCodes.UNAUTHORIZED
      );
    } else if (err instanceof jwt.JsonWebTokenError) {
      throw new CustomError("ì˜ëª»ëœ í† í°ì…ë‹ˆë‹¤.", StatusCodes.BAD_REQUEST);
    } else {
      throw err;
    }
  }
};
```
